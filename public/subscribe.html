<!doctype html>
<html>
<head>
<meta charset="utf-8">
    <title>西瓜记公众号助手</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-production.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/smartadmin-skins.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/xiguaji.css">
    <script src="js/libs/jquery-2.0.2.min.js"></script>
    <script src="http://www.xiguaji.com/js/highcharts.js"></script>
    <script src="http://www.xiguaji.com/js/highcharts-more.js"></script>
    <style type="text/css">
        .subscribe-wrap{ border: 1px solid #e5e9ed; background: #fff;}
        .subscribe-charts{ background: url(img/subscribe/demand-bg.png) no-repeat; background-size:100% auto; min-height: 700px; position: relative;}
        .subscribe-chosen{ background: #f8f9fb; border-left: 1px solid #e5e9ed; min-height: 700px;}
        .subscribe-list{}
        .subscribe-list .subscribe-item{ position: absolute;text-align: center; font-size: 16px;}
        .subscribe-list .subscribe-item div{border-radius: 100%; }
        .subscribe-item-0{  color: #d34ad8;}
        .subscribe-item-0 div{ background: #d34ad8;}
        .subscribe-item-1{ color: #e74c3c;}
        .subscribe-item-1 div{ background: #e74c3c;}
        .subscribe-item-2{ color: #ff8106;}
        .subscribe-item-2 div{ background: #ff8106;}
        .subscribe-item-3{ color: #46be68;}
        .subscribe-item-3 div{ background: #46be68;}
        .subscribe-item-4{ color: #ffb400;}
        .subscribe-item-4 div{ background: #ffb400;}
        .subscribe-item-5{ color: #50d2d0;}
        .subscribe-item-5 div{ background: #50d2d0;}
    </style>
</head>
<body class="fixed-navigation fixed-header fixed-ribbon">
    <!-- #HEADER -->
    <header id="header">
        <div id="logo-group">
            <!-- PLACE YOUR LOGO HERE -->
            <span id="logo" class=""> <img src="img/logo.png" alt="微圈助手管理后台"> </span>
            <!-- END LOGO PLACEHOLDER -->
			<span class="activity-dropdown" id="activity"> <i class="fa fa-bell"></i> <b class="badge bounceIn animated">3</b></span>
			<div class="ajax-dropdown" style="display:none;">
				<div class="btn-group btn-group-justified">
					<a class="btn btn-default active">全部 <span class="message-count">(14)</span></a>
					<a class="btn btn-default">未读 <span class="message-count">(3)</a>
					<a class="btn btn-default">已读 <span class="message-count">(11)</span></a>
				</div>
				<!-- notification content -->
				<div class="ajax-notifications custom-scroll">
					<div class="alert alert-transparent" style="display:none;">
						<i class="fa fa-envelope-o fa-4x fa-border"></i>
						<h4 class="text-align-center">暂无消息</h4>
					</div>
					<div class="messageList" style="display:none;">
						<ul class="messageBody list-unstyled">
							<li>
								<i class="openStat fa fa-envelope"><em></em></i>
								<div class="messageEntry">
									<h3>优惠券</h3>
									<p>恭喜您，收到1张90元的优惠券，有效期截止至2015年6月1日</p>
									<div class="messageInfo"><i class="fa fa-clock-o"></i> 04-29 19:35<a class="btn btn-xs btn-default">查看详情</a></div>
								</div>
							</li>
							<li>
								<i class="openStat fa fa-envelope"><em></em></i>
								<div class="messageEntry">
									<h3>服务器升级公告</h3>
									<p>西瓜公众号助手将于2015-5-30 0:00:00至2015-5-30 2:00:00进行服务器升级，届时将暂停本站使用功能。</p>
									<div class="messageInfo"><i class="fa fa-clock-o"></i> 04-29 19:35<a class="btn btn-xs btn-default">查看详情</a></div>
								</div>
							</li>
							<li class="hasRead">
								<i class="openStat fa fa-envelope"><em></em></i>
								<div class="messageEntry">
									<h3>服务器升级公告</h3>
									<p>西瓜公众号助手将于2015-5-30 0:00:00至2015-5-30 2:00:00进行服务器升级，届时将暂停本站使用功能。</p>
									<div class="messageInfo"><i class="fa fa-clock-o"></i> 04-29 19:35<a class="btn btn-xs btn-default">查看详情</a></div>
								</div>
							</li>	
						</ul>
						<a class="btn btn-default moreMessage">加载更多...</a>
					</div>
					<div class="messageDetail">
						<div class="messageEntry">
							<h3>优惠券</h3>
							<p>恭喜您，收到1张90元的优惠券，有效期截止至2015年6月1日</p>
							<div class="messageInfo"><i class="fa fa-clock-o"></i> 04-29 19:35<a class="btn btn-default">返回</a></div>
						</div>
					</div>
				</div>
				<!-- end notification content -->
			</div>
        </div>
        <!-- pulled right: nav area -->
        <div class="pull-right">
        </div>
        <!-- end pulled right: nav area -->
    </header>
    <!-- END HEADER -->
    <!-- #NAVIGATION -->
    <!-- Left panel : Navigation area -->
    <aside id="left-panel">
        <!-- User info -->
        <div class="login-info">
            <span>
                <a href="javascript:void(0);" id="show-shortcut" data-action="toggleShortcut">
                    <img src="img/avatars/sunny.png" alt="me" class="online" />
                    <span>
                        微圈助手管理员
                    </span>
                    <i class="fa fa-angle-down"></i>
                </a>
            </span>
        </div>
        <!-- end user info -->
        <nav>
            <ul>
                <li class="">
                    <a href="/Home/Dashboard" title="西瓜记-工作台"><i class="fa fa-lg fa-fw fa-home"></i> <span class="menu-item-parent">工作台</span></a>
                </li>
                <li>
                    <a href="#"><i class="fa fa-lg fa-fw fa-paper-plane"></i> <span class="menu-item-parent">爆文使用</span></a>
                    <ul>
                        <li>
                            <a href="/Group/List">爆文使用</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-lg fa-fw fa-user"></i> <span class="menu-item-parent">爆文收集</span></a>
                    <ul>
                        <li>
                            <a href="/WeiXinUser/List">我关注的爆文</a>
                        </li>
                        <li>
                            <a href="/UserTopic/List">系统推荐爆文</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-lg fa-fw fa-empire"></i> <span class="menu-item-parent">公众号管理</span></a>
                    <ul>
                        <li>
                            <a href="/RealTopic/List">添加公众号</a>
                        </li>
                        <li>
                            <a href="/Subject/List">我关注的公众号</a>
                        </li>
                        <li>
                            <a href="/SubjectUserMap/List">热门爆文来源</a>
                        </li>
                    </ul>
                </li>
                <li class="">
                    <a href="/GlobalConfig/List" title="系统配置"><i class="fa fa-lg fa-fw fa-cube txt-color-blue"></i> <span class="menu-item-parent">系统配置</span></a>
                </li>
            </ul>
        </nav>
    </aside>
    <!-- END NAVIGATION -->
    <!-- #MAIN PANEL -->
    <div id="main" role="main">
        <!-- RIBBON -->
        <div id="ribbon">
            <!-- breadcrumb -->
            <ol class="breadcrumb"><li>管理</li><li>爆文收集</li><li>热门爆文</li></ol>
            <!-- end breadcrumb -->
        </div>
        <!-- END RIBBON -->
        <!-- #MAIN CONTENT -->
        <div id="content">
<!-- 			<div class="loadingWrap"><div class="spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div></div> -->

        <div class="container-fluid">
          <div class="row subscribe-wrap">
            <div class="col-md-9 subscribe-list">
                <h1>关键词智能推荐</h1>
                <p class="subscribe-sub-title">2015-12-21 更新</p>
                <div id="charts" class="subscribe-charts">

                </div>
            </div>
            <div class="col-md-3 subscribe-chosen">

            </div>
          </div>
        </div>
			
    



        </div>
        <!-- END #MAIN CONTENT -->
    </div>
    <!-- END #MAIN PANEL -->
    <!-- #PAGE FOOTER -->
    <div class="page-footer">
        <div class="row">
            <div class="col-xs-12 col-sm-6">
                <span class="txt-color-white">西瓜公众号助手 &copy; 2014-2016</span>
            </div>
            <!-- end col -->
        </div>
        <!-- end row -->
    </div>
    <!-- END FOOTER -->
<div class="modal fade in" style="display:none;">
    <div class="modal-dialog">
        <div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
				<h4 class="modal-title">激活账号</h4>
			</div>
			<div class="modal-body no-padding">
				<div class="row no-margin activeBox" style="display:none;">
					<div class="col col-md-3">
						<img src="img/qrcode.png" class="activeBoxQrcode">
					</div>
					<div class="col col-md-9">
						<section>请扫描左侧二维码关注公众号悄悄，即可免费获得激活码，激活码仅限自己使用。</section>
						<section>
							<input type="text" placeholder="激活码" class="form-control" />
							<button type="submit" class="btn btn-primary">
								激活
							</button>
						</section>
					</div>
				</div>
				<div class="activeSuccess">
					<i class="fa fa-check-circle"></i> 激活成功 [到期时间延长至：2015-09-01]
					<a class="btn btn-primary">返回</a>
				</div>
			</div>
		</div>
    </div>
</div>
<script>


var CollisionResolver = function (radius){
    this.radius = radius || 3.5; // degrees
    this.groups = [];
    this.collision = {};
    this.objects = {};
    this.num_obj = 0;
}



function GetRandomNum(Min,Max){
    var Range = Max - Min;
    var Rand = Math.random();
    return (Min + Math.round(Rand * Range));
}

var max = {
    left: $('#charts').width() - 100,
    top: $('#charts').height() - 100
}
var data = [
    {weight: 100, name: '妹子222'},
    {weight: 1, name: '妹子'},
    {weight: 22, name: '妹子'},
    {weight: 44, name: '妹子'},
    {weight: 55, name: '妹子'},
    {weight: 66, name: '妹子'},
    {weight: 77, name: '妹子'},
    {weight: 88, name: '妹子3'},
    {weight: 99, name: '妹子2'},
    {weight: 46, name: '妹子'},
    {weight: 4, name: '妹子'},
    {weight: 84, name: '妹子'},
    {weight: 22, name: '妹子'},
    {weight: 57, name: '妹子'},
    {weight: 43, name: '妹子'},
    {weight: 38, name: '妹子'},
    {weight: 35, name: '妹子'},
    {weight: 96, name: '妹子325'},
    {weight: 52, name: '妹子'},
    {weight: 85, name: '妹子235'},
    {weight: 35, name: '妹子'}
];

$.map(data, function(val, i){
    val.z = GetRandomNum(30, 50);
    if(val.weight < 34){
        val.x = GetRandomNum(max.left / 4, max.left / 8 * 5);
        val.y = Math.random() > 0.5 ? GetRandomNum(max.top / 4, max.top / 8 * 3) : GetRandomNum(max.top / 8 * 5, max.top / 4 * 3);
    } else if(val.weight < 67){
        val.x = GetRandomNum(max.left / 8, max.left / 8 * 7);
        val.y = Math.random() > 0.5 ? GetRandomNum(max.top / 8, max.top / 4) : GetRandomNum(max.top / 4 * 3, max.top / 8 * 7);
    } else{
        val.x = GetRandomNum(0, max.left);
        val.y = Math.random() > 0.5 ? GetRandomNum(0, max.top / 8) : GetRandomNum(max.top / 8 * 7, max.top);
    }
    if(val.weight == 100){
        val.x = max.left / 2 - 50;
        val.y = max.top / 2 - 50;
        val.z = 100;
    }
    return val;
});

console.log(data)

for(var i = 0; i < data.length; i++){
    $('<div style="left: ' + data[i].x + 'px; top: ' + data[i].y + 'px;" class="subscribe-item subscribe-item-' + GetRandomNum(0, 5) + '"><div style=" width:' + data[i].z + 'px; height: ' + data[i].z + 'px; "></div>' + data[i].name + '</div>').appendTo('.subscribe-charts');
}



// $(function () {
//     $('#charts').highcharts({

//         chart: {
//             type: 'bubble',
//             plotBorderWidth: 0,
//             zoomType: 'xy',
//             backgroundColor: 'rgba(0,0,0,0)',
//             className: 'subscribe-charts',
//             style: {

//             }
//         },

//         title: {
//             text: null
//         },

//         legend: {
//             enabled: false
//         },
//         tooltip: {
//             useHTML: true,
//             headerFormat: '<table>',
//             pointFormat: '<tr><th colspan="2"><h3>{point.name}</h3></th></tr>' +
//                 '<tr><th>Fat intake:</th><td>{point.x}g</td></tr>' +
//                 '<tr><th>Sugar intake:</th><td>{point.y}g</td></tr>' +
//                 '<tr><th>Obesity (adults):</th><td>{point.z}%</td></tr>',
//             footerFormat: '</table>',
//             followPointer: true
//         },

//         plotOptions: {
//             series: {
//                 dataLabels: {
//                     enabled: true,
//                     y: -30,
//                     format: '{point.name}'
//                 }
//             }
//         },

//         series: [{
//             data: data
//         }]

//     });
// });
</script>

<script type="text/javascript">
var CollisionResolver = function (radius)
{
    this.radius = radius || 3.5; // degrees
    this.groups = [];
    this.collision = {};
    this.objects = {};
    this.num_obj = 0;
}

CollisionResolver.prototype = 
{
    // add an object to the circle
    add: function (obj)
    {
        function sort_group ()
        {
            group.elem.sort(function(a,b) {return a.pos>b.pos; });
            var middle = 0;
            for (var i = 0; i != group.elem.length ; i++) middle += group.elem[i].pos;
            middle /=  group.elem.length;
            var range = this.radius * group.elem.length;
            group.min = middle-range;
            group.max = middle+range;
            
            // see if the expanded group now overlaps another
            for (var g = 0 ; g != this.groups.length ; g++)
            {
                var group2 = this.groups[g];
                if (group2 == group) continue;
                for (var offset = 0 ; offset <720 ; offset += 360)
                {
                    if (  (group2.max+offset > group.min)
                       && (group2.min+offset < group.max))
                    {
console.log ("merge("+offset+") "+Math.round(group.min)+" "+Math.round(group.max)+" into "+Math.round(group2.min)+" "+Math.round(group2.max));
                        // merge groups
                        for (var i = 0 ; i != group2.elem.length ; i++) group2.elem[i].pos += offset;
                        group.elem = group.elem.concat(group2.elem);
                        this.groups.splice (g, 1);
                        
                        // try again with the merged group
                        sort_group.call (this,group);
                        return;
                    }
                }
            }
        }
        
        // store the object
        obj.id = this.num_obj;
        this.objects[this.num_obj++] = obj;
        
        // see if the object falls within a collision group
        for (var g in this.groups)
        {
            var group = this.groups[g];
            for (var offset = 0 ; offset <720 ; offset += 360)
            {
                if (  (obj.pos+offset+this.radius > group.min)
                   && (obj.pos+offset-this.radius < group.max))
                {
                    // insert the object into the collision group
                    obj.pos += offset;
                    group.elem.push (obj);
                    sort_group.call (this, group);
                    return;
                }
            }
        }
    
        // create a new singleton collision group
        var group = { 
            elem: [obj],
            min :obj.pos-this.radius,
            max :obj.pos+this.radius };
        this.groups.push (group);
    },
    
    resolve: function ()
    {
        // spread the objects inside each group
        var groups = this.groups;
        for (var i = 0 ; i != groups.length ; i++)
        {
            var group = groups[i];
            for (var o = 0 ; o != group.elem.length ; o++)
            {
console.log ("spread "+i+"."+o+" "+Math.round(group.elem[o].pos)+" -> "+Math.round(group.min + (2*o+1) * this.radius));
                group.elem[o].pos = (group.min + (2*o+1) * this.radius + 360) % 360;
            }
        }
        
        // return the positions
        var res = [];
        for (var i = 0 ; i != this.num_obj ; i++) res.push (this.objects[i].pos);
        return res;
    }
}

function spread (positions, radius)
{
    var collider = new CollisionResolver (radius);
    
    // initialize object positions
    for (var i = 0; i != positions.length ; i++)
    {
        collider.add ({ pos:positions[i]} );
    }
    
    draw_collider (collider);
    
    // resolve collisions
    return collider.resolve();  
}

function draw_circles (input, output, radius)
{
    function is_close (a, b) { return Math.abs (a-b) < 1e-2; }
    
    function draw_points (a1, r1, a2, r2)
    {
        function draw_point (a, r)
        {
            a *= Math.PI/180;
            var size = radius*Math.PI/180*r;
            var xc = xd/2+r*Math.cos(a);
            var yc = xd/2+r*Math.sin(a);
            ctx.beginPath();
            ctx.arc (xc, yc, size, 0, 2*Math.PI);
            ctx.closePath();
            ctx.stroke();
            ctx.fill ();
            return {x:xc, y:yc};
        }
        
        ctx.fillStyle = 'blue';
        var p1 = draw_point (a1,r1);
        ctx.fillStyle = is_close(a1, a2) ? 'green' : 'orange';
        var p2 = draw_point (a2,r2);
        ctx.beginPath();
        ctx.moveTo (p1.x, p1.y);
        ctx.lineTo (p2.x, p2.y);
        ctx.closePath();
        ctx.stroke();
    }
    
    var xd, yd, r1, r2;
    xd = yd = 400;
    r1 = xd/2*.6;
    r2 = xd/2*.8;
    var canvas = document.getElementById ('canvas');
    var ctx = canvas.getContext("2d");
    ctx.strokeStyle = 'red';
    ctx.beginPath();
    ctx.arc (xd/2, yd/2, r1, 0, 2*Math.PI);
    ctx.closePath();
    ctx.stroke();
    ctx.beginPath();
    ctx.arc (xd/2, yd/2, r2, 0, 2*Math.PI);
    ctx.closePath();
    ctx.stroke();
    for (var i = 0; i != input.length ; i++)
    {
        draw_points (input[i], r1, output[i], r2);
    }
}

function draw_collider (collider)
{
    function draw_group (group)
    {
        ctx.beginPath();
        ctx.arc (xd/2, yd/2, r1, 0, 2*Math.PI);
        ctx.closePath();
        ctx.stroke();
        var amin = group.min*Math.PI/180;
        var amax = group.max*Math.PI/180;
        var x2 = xd/2+r2*Math.cos(amax);
        var y2 = xd/2+r2*Math.sin(amax);
        ctx.beginPath();
        ctx.arc (xd/2, yd/2, r1, amin, amax);
        ctx.lineTo (x2, y2);
        ctx.arc (xd/2, yd/2, r2, amax, amin, true);
        ctx.closePath();
        ctx.fill();
    }
    
    var xd, yd, r1, r2;
    xd = yd = 400;
    r1 = xd/2*.6;
    r2 = xd/2*.8;
    var canvas = document.getElementById ('canvas');
    canvas.width  = xd;
    canvas.height = yd;
    var ctx = canvas.getContext("2d");
    ctx.fillStyle = ctx.strokeStyle='cyan';
    for (var i = 0; i != collider.groups.length ; i++)
    {
        draw_group (collider.groups[i]);
    }
}

function demo ()
{
    var input = [];
    for (var i = 0 ; i != 10 ; i++) input[i] = Math.random() * 360;
    
    var output = spread (input, 7);
    draw_circles (input, output, 7);
    //draw_circles (input, input);
}

window.onload = demo;

</script>
</body>
</html>